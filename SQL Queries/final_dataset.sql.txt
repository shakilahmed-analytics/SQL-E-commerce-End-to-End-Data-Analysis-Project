CREATE TABLE final_dataset AS
SELECT
o.order_id,
o.order_purchase_timestamp AS order_date,
o.order_status,
o.delivery_days,

c.customer_city_clean AS customer_city,
c.customer_state_clean AS customer_state,

p.category_english AS product_category,
oi.price,
oi.freight_value AS shipping_cost,
oi.total_item_cost,

pay.total_payment,
s.seller_state AS seller_state,
r.review_score

FROM olist_orders_dataset o
JOIN olist_customers_dataset c ON o.customer_id = c.customer_id
JOIN olist_order_items_dataset oi ON o.order_id = oi.order_id
JOIN olist_products_dataset p ON oi.product_id = p.product_id
JOIN payments_summary pay ON o.order_id = pay.order_id
JOIN olist_sellers_dataset s ON oi.seller_id = s.seller_id
LEFT JOIN olist_order_reviews_dataset r ON o.order_id = r.order_id;
